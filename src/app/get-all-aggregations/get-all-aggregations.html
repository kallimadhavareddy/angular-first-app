<div class="aggregations-container">
  @if (error()) {
    <div class="error-message">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" fill="currentColor"/>
      </svg>
      <strong>Error:</strong> {{ error() }}
    </div>
  }

  @if (loading()) {
    <div class="loading-container">
      <div class="spinner"></div>
      <p>Loading API data...</p>
    </div>
  }

  <div class="aggregations-grid">
    

    @if (apiResponse()?.user) {
      <div class="data-card user-card">
        <div class="card-header">
          <div class="header-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" fill="currentColor"/>
            </svg>
          </div>
          <div class="header-content">
            <h3>User Information</h3>
            <p class="card-subtitle">Profile details</p>
          </div>
          <div class="card-badge">
            ID: {{ apiResponse()!.user!.id }}
          </div>
        </div>
        <div class="card-content">
          <div class="user-details">
            <div class="user-avatar">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" fill="currentColor" opacity="0.3"/>
              </svg>
            </div>
            <div class="user-info">
              <div class="info-item">
                <span class="info-label">Name</span>
                <span class="info-value">{{ apiResponse()!.user!.name }}</span>
              </div>
              <div class="info-item">
                <span class="info-label">Username</span>
                <span class="info-value">@{{ apiResponse()!.user!.username }}</span>
              </div>
              <div class="info-item">
                <span class="info-label">Email</span>
                <span class="info-value">{{ apiResponse()!.user!.email }}</span>
              </div>
              <div class="info-item">
                <span class="info-label">Phone</span>
                <span class="info-value">{{ apiResponse()!.user!.phone }}</span>
              </div>
              <div class="info-item">
                <span class="info-label">Website</span>
                <span class="info-value">{{ apiResponse()!.user!.website }}</span>
              </div>
            </div>
          </div>
          @if (apiResponse()!.user!.address) {
            <div class="address-section">
              <h4>Address</h4>
              <div class="address-info">
                <p>{{ apiResponse()!.user!.address!.street }}, {{ apiResponse()!.user!.address!.suite }}</p>
                <p>{{ apiResponse()!.user!.address!.city }}, {{ apiResponse()!.user!.address!.zipcode }}</p>
              </div>
            </div>
          }
        </div>
      </div>
    }

    @if (apiResponse()?.headerResponse) {
      <div class="data-card header-card">
        <div class="card-header">
          <div class="header-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z" fill="currentColor"/>
            </svg>
          </div>
          <div class="header-content">
            <h3>Header Response</h3>
            <p class="card-subtitle">Request metadata</p>
          </div>
          <div class="card-badge">
            HTTP
          </div>
        </div>
        <div class="card-content">
          <div class="info-grid">
            <div class="info-item">
              <span class="info-label">Origin</span>
              <span class="info-value">{{ apiResponse()!.headerResponse!.origin }}</span>
            </div>
            <div class="info-item">
              <span class="info-label">URL</span>
              <span class="info-value">{{ apiResponse()!.headerResponse!.url }}</span>
            </div>
          </div>
          @if (apiResponse()!.headerResponse!.headers) {
            <div class="headers-section">
              <h4>Request Headers</h4>
              <div class="headers-list">
                @for (header of getKeys(apiResponse()!.headerResponse!.headers); track header) {
  <div class="header-item">
    <span class="header-key">{{ header }}</span>
    <span class="header-value">{{ apiResponse()!.headerResponse!.headers![header] }}</span>
  </div>
}
              </div>
            </div>
          }
        </div>
      </div>
    }

    @if (!loading() && !apiResponse()) {
      <div class="empty-state">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z" fill="currentColor" opacity="0.3"/>
        </svg>
        <h3>No Data Available</h3>
        <p>API response data will appear here once loaded</p>
      </div>
    }
  </div>

  @if (apiResponse()?.exchangeRateResponse) {
      <div class="data-card exchange-rates-card">
        <div class="card-header">
          <div class="header-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1.81.45 1.61 1.67 1.61 1.16 0 1.6-.64 1.6-1.46 0-.84-.68-1.22-2.05-1.68-1.43-.48-3.23-1.14-3.23-3.23 0-1.62 1.18-2.79 2.91-3.18V5h2.67v1.71c1.63.42 2.58 1.62 2.67 3.15h-1.96c-.05-.8-.41-1.43-1.33-1.43-1.06 0-1.5.58-1.5 1.28 0 .78.67 1.15 2.04 1.6 1.44.47 3.24 1.13 3.24 3.31 0 1.77-1.26 3.06-3.05 3.47z" fill="currentColor"/>
            </svg>
          </div>
          <div class="header-content">
            <h3>Exchange Rates</h3>
            <p class="card-subtitle">Real-time currency data</p>
          </div>
          <div class="card-badge">
            {{ apiResponse()!.exchangeRateResponse!.base }}
          </div>
        </div>
        <div class="card-content">
          <div class="info-grid">
            <div class="info-item">
              <span class="info-label">Provider</span>
              <span class="info-value">{{ apiResponse()!.exchangeRateResponse!.provider }}</span>
            </div>
            <div class="info-item">
              <span class="info-label">Date</span>
              <span class="info-value">{{ apiResponse()!.exchangeRateResponse!.date }}</span>
            </div>
          </div>
          <div class="rates-container">
            <h4>Currency Rates</h4>
            <div class="rates-grid">
              @for (currency of getKeys(apiResponse()!.exchangeRateResponse!.rates); track currency) {
                <div class="rate-item">
                  <span class="currency-code">{{ currency }}</span>
                  <span class="currency-value">{{ apiResponse()!.exchangeRateResponse!.rates![currency] }}</span>
                </div>
              }
            </div>
          </div>
        </div>
      </div>
    }
</div>
